<apex:page showHeader="false" renderAs="pdf" sidebar="false" standardStylesheets="false" applyBodyTag="false" applyHtmlTag="false" standardController="pse__Proj__c" extensions="ECO_ProjectPlanControllerPdf">
    <head>
        
        <apex:includeScript value="{!$Resource.ECO_jQuery_1_11_2_min_js}"/>
        
        <style type="text/css" media="print">
            @page{
                size:landscape;
                padding-top:60px;
                @top-center {
                    content: element(header);
                }

                @bottom-right {
                    content: "Page " counter(page) " of " counter(pages);
                    font-family: sans-serif;
                    font-size: 80%;
                }
            }
            @page :first {
                @bottom-right {
                 /* Nothing */
                }
            }
            body{
                font-family:arial, sans-serif;
                font-size:80%;
            }

            .header{
                display:block;
                padding-bottom: 40px;
                position: running(header);
            }

            .headerInline{
                height:75px;
                border-bottom: 2px solid #DDDDDD;
                padding:0 0 15px 0; 
                margin: 10px 0 25px 0;
                background-position:top right;
                background-repeat:no-repeat;
                background-size:5% auto !important;
                background-image : url({!URLFOR($Resource.ECO_CustomGraphicAssets, 'PDFLogo.jpg')});
            }
            .headerInline h1{
                margin:-2px 0 0 0;
                font-size:16px;
                line-height:80%;
            }
            .headerInline h2{
                font-size:16px;
                line-height:80%;
            }
            .headerInline h5{
                line-height:80%;
                margin:0;
            }
            .rightHeaderInfo{
                float:right; 
                border-left:2px solid #ddd; 
                height:40px;
                vertical-align:middle; 
                padding-left:55px;
                position:absolute;
                right:0;
                top:0;
                padding:50px 10px 0 25px;
                margin-top:10px;
                width:150px;
            }

            table{
                border: 1px solid #ddd;
                width:100%; 
            }
            table tr th {
                vertical-align: bottom;
                background-color: #f8f8f8;
                
            }
            table>caption+thead>tr:first-child>td, table>caption+thead>tr:first-child>th, table>colgroup+thead>tr:first-child>td, table>colgroup+thead>tr:first-child>th, table>thead:first-child>tr:first-child>td, table>thead:first-child>tr:first-child>th {
                border-top: 0;
            }
            table>tbody>tr>td, table>tbody>tr>th, table>tfoot>tr>td, table>tfoot>tr>th, table>thead>tr>td, table>thead>tr>th, table tr td, table tr th {
                padding: 5px;
                line-height: 1.42857143;
                vertical-align: top;
                border-top: 1px solid #ddd;
            }
            table tr > td > td, table tr > td > tr > td, td > td, td > span > table tr td, td > table tr td, td > span > table, td > table {
                border:none;
                padding:0;
            }
            .notificationAndAlerts > span > div > table > tbody > tr:last-child, .notificationAndAlerts > span > div > table > tbody > tr > td:first-child, .notificationAndAlerts td:first-child, .notificationAndAlerts table tr:last-child {
                display:none;
                border:none;
                padding:0;
                width:0;
            }
            .notificationAndAlerts table > tbody > tr > td:first-child, .notificationAndAlerts table > tbody > tr:last-child{
                display:none;
            }

            .pbHeader > table > tbody > tr > td, .pbHeader > table, .pbHeader table td, .pbHeader table{
                border:none !important;
                padding: 0;
            }
            .pbHeader{
                
            }
            .pbSubheader {
                margin: 6px 0 0 0;
                background-color:#008cb2;
                color:#fff;
                -moz-border-radius: 4px 4px 0 0;
                -webkit-border-radius:  4px 4px 0 0;
                border-radius:  4px 4px 0 0;
                border-top: 3px solid #f8f8f8;
                padding:4px 12px 4px 12px;
            }
            .pbSubheader h3{
                margin:0;
            }
            .footer{
                position:absolute; width:100%; height:100px; bottom:0; border-top:1px solid #4a4a56; padding-top:15px;
            }
            .risk{
                background:#ebebeb;
            }
            .notificationAndAlerts table, .notificationAndAlerts td{
                border:none !important;
                width:auto;
                padding:0;
            }
            .mainTitle{
                margin:15px 0 -5px 0;
            }

            .relatedListIcon{
                display: none;
            }

            .budgetFrameWrapper th, .budgetFrameWrapper td {
                border-top: 1px solid black;
                border-bottom: 1px solid black;
                border-left: 1px solid black;
                border-right: 1px solid black;
                border-collapse: collapse;        
                padding: 5px;
                text-align: left;
            }
            .budgetFrameWrapper table {
                border: none;
                border-collapse: collapse;
                font-size:8px;
            }
            
            .budgetFrameWrapper .dollarAmount {
                text-align:right;
            }
            
            .budgetFrameWrapper .percentAmount {
                text-align:center;
            }
            
            .budgetFrameWrapper .rightBlue {
                background-color:#0070C0;color:white;text-align:right
            }
            
            .budgetFrameWrapper .centerBlue {
                background-color:#0070C0;color:white;text-align:center
            }
            
            .budgetFrameWrapper .rightGreen {
                background-color:#76933C;color:white;text-align:right
            }
            
            .budgetFrameWrapper .centerGreen {
                background-color:#76933C;color:white;text-align:center
            }
            
            .budgetFrameWrapper .rightPurple {
                background-color:#60497A;color:white;text-align:right
            }
            
            .budgetFrameWrapper .centerPurple {
                background-color:#60497A;color:white;text-align:center
            }
            
            .budgetFrameWrapper .rightOrange {
                background-color:#FF9900;color:white;text-align:right
            }
            
            .budgetFrameWrapper .centerOrange {
                background-color:#FF9900;color:white;text-align:center
            }
            
            .budgetFrameWrapper .lightBlue {
                background-color:#DCE6F1;
            }
            
            .budgetFrameWrapper .lightGreen {
                background-color:#EBF1DE;
            }
            
            .budgetFrameWrapper .lightPurple {
                background-color:#E4DFEC;
            }
            
            .budgetFrameWrapper .lightOrange {
                background-color:#FDE9D9;
            }
            
            .budgetFrameWrapper .bold {
                font-weight:bold;
            }        
        </style>

    </head>
        <div class="header">
            <div class="headerInline">
                <h5>Project Plan</h5>
                <h2 style="line-height:80%;">Project: {!theProject.Name}</h2>
                <h2 style="line-height:80%;">Date: {!now()}</h2>
                            
                <div class="rightHeaderInfo">
                    Project ID:<br/>
                    {!theProject.ProjectNumber__c}
                </div>
            </div>
        </div>

        <h2 style="line-height:80%;">Project: {!theProject.Name}</h2>
        <h1>PROJECT PLAN</h1>
        <br/>
        <h2 style="line-height:80%;">Client: {!theProject.PrimaryEndClient__c}</h2>
        <h2 style="line-height:80%;">Project Number: {!theProject.OracleProjectnumber__c}</h2>
        <h2 style="line-height:80%;">Date: {!now()}</h2>
        <h2 style="line-height:80%;">Project ID: {!theProject.ProjectNumber__c}</h2>
                        
        <apex:pageMessages id="pageMessages"/>
       
        <apex:relatedList list="ProcessSteps" />
       
        <p style="page-break-after:always;"></p>

        <apex:pageBlock title="Project Information">
            <apex:pageBlockSection title="Project Information" collapsible="true" columns="4">
                <apex:repeat value="{!$ObjectType.pse__Proj__c.FieldSets.ECO_ProjectPlanPdf}" var="f">
                    <apex:outputField value="{!pse__Proj__c[f]}" /><br/>
                </apex:repeat>
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <br/>
        <h2>Project Description</h2>
        <br/>
        <apex:outputText value="{!theProject.ProjectDescription__c}" /><br/>
        <p style="page-break-after:always;"></p>
        
        <apex:pageBlock title="Project Scope">
            <apex:pageBlockSection title="Project Scope Detail" columns="2" collapsible="false">
                <apex:outputText value="{!oProjectPackage.PackageTitle__c}" />
                <apex:outputField id="first" value="{!oProjectPackage.Scope_Owner__c}" />
                <apex:outputField value="{!oProjectPackage.Status__c}" />
                <apex:outputField value="{!oProjectPackage.CancelledReason__c}" />
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1"  >
                <apex:pageblockSectionItem helpText="{!$ObjectType.Packages__c.Fields.Scope_Details__c.inlineHelpText}"  >
                    <apex:outputText value="{!$ObjectType.Packages__c.Fields.Scope_Details__c.Label}" />
                    <apex:outputField value="{!oProjectPackage.Scope_Details__c}" />
                </apex:pageblockSectionItem>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1">
                <apex:pageblockSectionItem helpText="{!$ObjectType.Packages__c.Fields.Scope_Approach__c.inlineHelptext}" >
                    <apex:outputText value="{!$ObjectType.Packages__c.Fields.Scope_Approach__c.Label}" />
                    <apex:outputField value="{!oProjectPackage.Scope_Approach__c}" />
                </apex:pageblockSectionItem>
            
            </apex:pageBlockSection>
            
            <br /><br />
            <div style="font-weight:bold;padding:20px 10px 4px 10px;">BIM</div>
            <div style="padding:10px">
                This project will use Digital Production Tools, or manage information in a common Data Environment.
                <c:ECO_HelpIcon helpText="{!$ObjectType.Packages__c.fields.Utilize_BMI_Technology__c.inlineHelpText}" />                
                &nbsp;&nbsp;
                <apex:outputField value="{!oProjectPackage.Utilize_BMI_Technology__c}" label="" />

                <br /><br />
                <apex:outputLink value="https://jonanunson.typeform.com/to/Fovnuf" target="_blank">BIM intake form</apex:outputLink>
            </div>
            
            <div style="font-weight:bold;padding:20px 10px 4px 10px;">Safety in Design</div>
            <div style="padding:10px">
                Project scope includes design where we need to incorporate Safety in Design (SiD).
                <c:ECO_HelpIcon helpText="Safety in Design (SiD) legislation generally requires all parties to do ‘what is practicable’ to reduce health and safety risks and applies to all designers and design activities regardless of discipline. This implies a duty on clients to participate in, or provide information for, design activities relevant to identifying and reducing safety risks at the planning and design stage. It is implicit that staff, at all levels, take action to design out safety and health risks that are readily identifiable.<br/><br/> 
                                          “Design” includes drawings, design details, specifications and bills of quantities (including specification of articles or substances) relating to a structure, and calculations prepared for the purpose of a design.<br/><br/> 
                                          “Designer” means any person (including a client, contractor or other person referred to in these Regulations) who in the course or furtherance of a business - (a) prepares or modifies a design; or (b) arranges for, or instructs, any person under their control to do so, relating to a structure, or to a product or mechanical or electrical system intended for a particular structure, and a person is deemed to prepare a design where a design is prepared by a person under their control." />                
                &nbsp;&nbsp;
                <apex:outputField value="{!oProjectPackage.SafetyInDesign__c}" label="" />

                <br /><br />
            </div>            

            <div style="font-weight:bold;padding:20px 10px 4px 10px;">Package Attachments</div>
            <apex:outputPanel rendered="{!oProjectPackage.Attachments.size == 0}" layout="block" style="padding:10px">
                <apex:pageMessage severity="info" summary="Package has no attachments" />
            </apex:outputPanel>
            <div style="padding:10px">
                <apex:pageBlockTable rendered="{!oProjectPackage.Attachments.size > 0}" value="{!oProjectPackage.Attachments}" var="attachment">
                    <apex:column width="60px">
                        <a href="/servlet/servlet.FileDownload?file={!attachment.Id}">View</a>
                    </apex:column>
                    <apex:column value="{!attachment.Name}"/>
                    <apex:column value="{!attachment.ContentType}"/>
                </apex:pageBlockTable>
            </div>
            
            <apex:outputPanel rendered="{!IF(oProjectPackage.Id ==null, false, true)}">

            <apex:variable value="{!lstMapAssignedDeliverables[oProjectPackage.Id]}"  var="myMap" />

            <apex:outputPanel >


                <div style="font-weight:bold;padding:20px 10px 4px 10px;">
                <apex:pageMessage severity="info" summary="Deliverables cannot be assigned until all packages are saved" rendered="{!booNewProjectInPlay}" />
                </div>

                <apex:outputPanel >

                    <apex:pageblocksection title="Assigned Deliverables" columns="1" collapsible="false">
                            <apex:facet name="header">
                                <apex:outputPanel >
                                    Assigned Deliverables
                                    <c:ECO_HelpIcon helpText="A list of Project Deliverables will appear here once added to the project.  Select the Scope Package to which the deliverable belongs to add the deliverable to that scope package." />
                                </apex:outputPanel>
                            </apex:facet>

                        
                        <apex:outputText Value="No Results Were Found." rendered="{!IF(myMap.size > 0, false, true)}" />

                        <apex:pageBlockTable value="{!lstMapAssignedDeliverables[oProjectPackage.Id]}" var="aRow" rendered="{!IF(myMap.size > 0, true, false)}">
                            <apex:column headerValue="Name">
                                <apex:outputfield value="{!aRow.oDeliverable.name}" />
                            </apex:column>
                            <apex:column headerValue="Assigned Scope">
                                <apex:outputField value="{!aRow.oDeliverable.Project_Scope__c}" />            
                            </apex:column>
                            <apex:repeat value="{!$ObjectType.Deliverable__c.FieldSets.Scope_Assigned_View}" var="Field">
                                <apex:column headerValue="{!Field.Label}">
                                    <apex:outputfield value="{!aRow.oDeliverable[Field]}" />
                                </apex:column>
                            </apex:repeat>
                        </apex:pageBlockTable>
                    </apex:pageblocksection>
                    <BR /><BR />

                </apex:outputPanel>

            </apex:outputPanel>
            </apex:outputPanel>
        </apex:pageBlock>
    
                <apex:repeat value="{!lstPackages}" var="ScopePackage">
                <apex:pageBlock title="{!IF(ScopePackage.PackageTitle__c=='', 'New Scope Package', ScopePackage.PackageTitle__c)}">

                <apex:pageBlockSection title="{!IF(ScopePackage.PackageTitle__c=='', 'New Scope Package', ScopePackage.PackageTitle__c)} "  columns="2"  collapsible="false">
    
                    <apex:outputField value="{!ScopePackage.PackageTitle__c}" />
                    <apex:outputField value="{!ScopePackage.Scope_Owner__c}" />
                    <apex:outputField value="{!ScopePackage.Status__c}" />
                    <apex:outputField value="{!ScopePackage.CancelledReason__c}" />
                </apex:pageBlockSection>
                <apex:pageBlockSection columns="1">
                    <apex:pageblockSectionItem helpText="{!$ObjectType.Packages__c.Fields.Scope_Details__c.inlineHelpText}">
                        <apex:outputText value="{!$ObjectType.Packages__c.Fields.Scope_Details__c.Label}" />
                        <apex:outputField value="{!ScopePackage.Scope_Details__c}" />
                    </apex:pageblockSectionItem>
                </apex:pageBlockSection>


                <br />
                <apex:pageBlockSection columns="1">
                    <apex:pageblockSectionItem helpText="{!$ObjectType.Packages__c.Fields.Scope_Approach__c.inlineHelpText}" >
                        <apex:outputText value="{!$ObjectType.Packages__c.Fields.Scope_Approach__c.Label}" />
                        <apex:outputField value="{!ScopePackage.Scope_Approach__c}" />
                    </apex:pageblockSectionItem>
                </apex:pageBlockSection>
                <br /><br />


                <div style="font-weight:bold;padding:20px 10px 20px 10px;">Package Attachments</div>
                <apex:outputPanel rendered="{!ScopePackage.Attachments.size == 0}" layout="block" style="padding:10px">
                    <apex:pageMessage severity="info" summary="Package has no attachments" />
                </apex:outputPanel>

                <div style="padding:10px">
                    <apex:pageBlockTable rendered="{!ScopePackage.Attachments.size > 0}" value="{!ScopePackage.Attachments}" var="attachment">
                        <apex:column width="60px">
                            <a href="/servlet/servlet.FileDownload?file={!attachment.Id}">View</a>
                        </apex:column>
                        <apex:column value="{!attachment.Name}"/>
                        <apex:column value="{!attachment.ContentType}"/>
                    </apex:pageBlockTable>
                </div>

                <apex:outputPanel rendered="{!IF(ScopePackage.Id ==null, false, true)}">
                <apex:outputPanel >

                      <apex:outputPanel >

                            <apex:pageblocksection columns="1" collapsible="false">
                            <apex:facet name="header">
                                <apex:outputPanel >
                                    Assigned Deliverables
                                    <c:ECO_HelpIcon helpText="A list of Project Deliverables will appear here once added to the project.  Select the Scope Package to which the deliverable belongs to add the deliverable to that scope package." />
                                </apex:outputPanel>
                            </apex:facet>
                                <apex:outputpanel rendered="true" >
                                </apex:outputpanel>
                                <apex:outputText Value="No Results Were Found." rendered="{!IF(MapRenderAssigned[ScopePackage.Id], false, true)}" />

                                <apex:pageBlockTable value="{!lstMapAssignedDeliverables[ScopePackage.Id]}" var="aRow" rendered="{!IF(MapRenderAssigned[ScopePackage.Id], true, false)}">
                                    <apex:column headerValue="Name">
                                        <apex:outputfield value="{!aRow.oDeliverable.name}" />
                                    </apex:column>
                                    <apex:column headerValue="Assigned Scope">
                                        <apex:outputField value="{!aRow.oDeliverable.Project_Scope__c}" />                      
                                    </apex:column>
                                    <apex:repeat value="{!$ObjectType.Deliverable__c.FieldSets.Scope_Assigned_View}" var="Field">
                                        <apex:column headerValue="{!Field.Label}">
                                            <apex:outputfield value="{!aRow.oDeliverable[Field]}" />
                                        </apex:column>
                                    </apex:repeat>
                                </apex:pageBlockTable>
                            </apex:pageblocksection>
                            <BR /><BR />

                        </apex:outputPanel>

                </apex:outputPanel>
                </apex:outputPanel>
                    </apex:pageBlock>
            </apex:repeat>
     
     <p style="page-break-after:always;"></p>
     <br/>       
     <h2 style="line-height:80%;">Deliverables and Technical Quality Review</h2>
     <br/>
     
     <apex:pageBlock >
        <apex:pageBlockSection title="Deliverables" columns="1" collapsible="false">
            <apex:pageBlockTable value="{!Deliverables}" rendered="{!Deliverables.size > 0}" var="deliverlist" rowClasses="even,odd">
                <apex:column headerClass="centerAlign" styleClass="leftAlign"><apex:facet name="header">Deliverable Name</apex:facet><apex:outputField value="{!deliverlist.Name}"/></apex:column>
                <apex:column headerClass="centerAlign" headerValue="Current Status" styleClass="centerAlign"><apex:outputField value="{!deliverlist.Status__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Deliverable Owner"><apex:outputField value="{!deliverlist.DeliverablesOwner__r.Name}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Delivery Type"><apex:outputField value="{!deliverlist.DeliverableType__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Due Date"><apex:outputField value="{!deliverlist.DueDate__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Submitted Date"><apex:outputField value="{!deliverlist.DateSubmitted__c}"/></apex:column>
            </apex:pageBlockTable>
            
            <apex:outputPanel rendered="{!Deliverables.size == 0}">
                <apex:outputText value="No deliverables to display"/>
            </apex:outputPanel> 
        </apex:pageBlockSection>
    </apex:pageBlock>    
    
    <!-- 
       For each of the deliverables, repeat
       show the deliverable detail in pageblocksection
       then show the team in a pageblock table
     -->
    <p style="page-break-after:always;"></p>
    <br/>
     <h2 style="line-height:80%;">List Of Deliverable Details</h2>
     <br/>
     <apex:repeat value="{!Deliverables}" var="d">
        <apex:pageBlock >
            <apex:pageBlockSection title="Deliverable Detail" columns="2" collapsible="false">
                <apex:outputField value="{!d.Name}" />
                <apex:outputField value="{!d.Status__c}" />
                <apex:outputField value="{!d.Project__c}" />
                <apex:outputField value="{!d.DeliverablesOwner__c}" />
                <apex:outputField value="{!d.Project_Scope__c}" />
                <apex:outputField value="{!d.DeliverableType__c}" />
                <apex:outputField value="{!d.DueDate__c}" />
                <apex:outputField value="{!d.DateSubmitted__c}" />
                <apex:outputField value="{!d.Description__c}" />
                <apex:outputField value="{!d.PracticeArea__c}" />                
            </apex:pageBlockSection>
            <br/>
            <apex:pageBlockSection title="Technical QualityTeam">
                 <apex:pageBlockTable value="{!d.Technical_Quality_Team__r}" rendered="{!d.Technical_Quality_Team__r.size > 0}" var="tqTeam" rowClasses="even,odd">
                    <apex:column headerClass="centerAlign" styleClass="leftAlign"><apex:facet name="header">Technical Quality Team #</apex:facet><apex:outputField value="{!tqTeam.Name}"/></apex:column>
                    <apex:column headerClass="centerAlign" headerValue="Role" styleClass="centerAlign"><apex:outputField value="{!tqTeam.Role__c}"/></apex:column>
                    <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Technical Quality Team Member"><apex:outputField value="{!tqTeam.TechnicalQualityTeamMember__c}"/></apex:column>
                    <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Review Date"><apex:outputField value="{!tqTeam.RequiredDate__c}"/></apex:column>
                    <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Status"><apex:outputField value="{!tqTeam.Status__c}"/></apex:column>
                </apex:pageBlockTable>
            </apex:pageBlockSection>
        </apex:pageBlock>
        <br/>
        <br/>
        
    </apex:repeat>
    
    <p style="page-break-after:always;"></p>
    <apex:pageBlock title="Project Key Members">
    <br/>
        <apex:pageBlockSection columns="1" collapsible="false">
                <apex:pageMessage severity="info" rendered="{!showVacantKeyMemberNote}" summary="One or more of this project's active Key Member roles is vacant." />
                <apex:pageBlockTable value="{!lActiveMembersKey}" var="item" width="100%" id="ActiveKeysTable">
                    <apex:column >
                        <apex:facet name="header">Role</apex:facet>
                        <apex:outputLabel value="{!item.RoleName}" rendered="{!if(item.RoleName != null, true, false)}"/>
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Name</apex:facet>
                        <apex:outputField value="{!item.oPTM.Contact__c}" /> 
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Start Date</apex:facet>
                        <apex:outputField value="{!item.oPTM.StartDate__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">End Date</apex:facet>
                        <apex:outputField value="{!item.oPTM.EndDate__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Phone</apex:facet>
                        <apex:outputField value="{!item.oPTM.Phone__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Email</apex:facet>
                        <apex:outputField value="{!item.oPTM.Email__c}" />
                    </apex:column>
                </apex:pageBlockTable>
        </apex:pageBlockSection>
    </apex:pageBlock>
  
    <apex:pageBlock title="Project Active Team Members (AECOM)">
    <br/>
        <apex:pageBlockSection columns="1" collapsible="false">
            <apex:outputPanel id="ProjectTeamTable">
                <apex:pageBlockTable value="{!lMembersTeam}" var="item" width="100%" columnsWidth="60px">
                    <apex:column >
                        <apex:facet name="header">Role Type</apex:facet>
                        <apex:outputText value="{!item.RoleName}"/>
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Name</apex:facet>
                        <apex:outputField value="{!item.oPTM.Contact__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Project Role Title</apex:facet>
                        <apex:outputField value="{!item.oPTM.ProjectRoleTitle__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Phone</apex:facet>
                        <apex:outputField value="{!item.oPTM.Phone__c}" />
                    </apex:column>
                    <apex:column >
                        <apex:facet name="header">Email</apex:facet>
                        <apex:outputField value="{!item.oPTM.Email__c}" />
                    </apex:column>
                </apex:pageBlockTable>
            </apex:outputPanel>
        </apex:pageBlockSection>
    </apex:pageBlock>       
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Subcontractors and Vendors</h2>
    <br/>
     
     <apex:pageBlock >
        <apex:pageBlockSection title="Subs and Vendors" columns="1" collapsible="false">
            <apex:pageBlockTable value="{!VendorSites}" var="Site" rendered="{!if(VendorSites.size > 0, true, false)}">
                <apex:repeat value="{!$ObjectType.VendorSite__c.FieldSets.VendorFinder_Display_Fieldset}" var="SearchField">
                    <apex:column value="{!Site[SearchField]}" />
                </apex:repeat>
            </apex:pageBlockTable>
            
            <apex:outputPanel rendered="{!VendorSites.size == 0}">
                <apex:outputText value="No Subs and Vendors to display"/>
            </apex:outputPanel> 
        </apex:pageBlockSection>
    </apex:pageBlock>    
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Stakeholders</h2>
    <br/>
         
    <apex:pageBlock >
        <apex:pageMessage severity="info"  escape="false"  summary="
                1. Engage with the appropriate Client Account or Program Manager when completing this section to ensure all appropriate client-related stakeholders are recognized and any client or account-specific communication strategies or gift and entertainment policies are identified and followed.<br/>
                2. Risks are inherent when the client contact or other stakeholders change during project execution.  Consider adding
                potential risks to the project Risk Register with proposed mitigation strategies when a new stakeholder
                is introduced to the project, such as holding a project review or kickoff meeting with the new contact.
                " />

        <apex:pageBlockSection title="Clients" columns="1" collapsible="false">
            <apex:pageBlockTable value="{!lProjectSites}" var="item" width="100%" id="ClientsTable" columnsWidth="60px" rendered="{!if(lProjectSites.size > 0, true, false)}">
                <apex:repeat value="{!$ObjectType.Project_Site__c.FieldSets.pse_ClientFinder_Display_Fieldset}" var="SearchField">
                    <apex:column value="{!item[SearchField]}" />
                </apex:repeat>
                <apex:column headerValue="Billing Client">
                    <apex:outputField value="{!item.Is_Billing__c}" />
                </apex:column>
                <apex:column headerValue="Primary Billing" >
                    <apex:outputField value="{!item.Is_Default_Top_Task__c}" />
                </apex:column>
                <apex:column headerValue="End Client" >
                    <apex:outputField value="{!item.Is_End__c}" />
                </apex:column>
                <apex:column headerValue="Primary End">
                    <apex:outputField value="{!item.Is_Primary_End__c}" />
                </apex:column>
            </apex:pageBlockTable>
            <!--  <apex:pageMessage severity="info" rendered="{!if(lAccounts.size = 0, true, false)}" summary="No Clients/Project Sites have been defined." /> -->
        </apex:pageBlockSection>

        <apex:pageBlockSection title="Others"  columns="1" collapsible="false">
            <!--   <apex:outputField value="{!pse__Proj__c.MediaInvolvement__c}" />  -->
            <apex:pageBlockTable value="{!lStakeholders}" var="item" width="100%" columnsWidth="60px" id="StakeholderTable">
                <apex:column >
                    <apex:facet name="header">Stakeholder Type</apex:facet>
                    <apex:outputField value="{!item.StakeholderType__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Organization</apex:facet>
                    <apex:outputField value="{!item.Organization__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Contact Name</apex:facet>
                    <apex:outputField value="{!item.ContactName__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Contact Phone</apex:facet>
                    <apex:outputField value="{!item.ContactPhone__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Interest</apex:facet>
                    <apex:outputField value="{!item.Interest__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">AECOM Contact</apex:facet>
                    <apex:outputField value="{!item.AECOMContact__c}" />
                </apex:column>
            </apex:pageBlockTable>
        </apex:pageBlockSection>
        
    </apex:pageBlock>

    <p style="page-break-after:always;"></p>
    <br/>
     <h2 style="line-height:80%;">Communication Activities</h2>
     <br/>
     
    <apex:pageBlock >
        <apex:pageBlockSection columns="1" collapsible="false">
            <apex:pageBlockTable value="{!lCommPlans}" var="item" width="100%" columnsWidth="60px" id="CommTable">
                <apex:column title="test">
                    <apex:facet name="header">Activity</apex:facet>
                    <apex:outputField value="{!item.Activity__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Audience</apex:facet>
                    <apex:outputField value="{!item.Audience__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Responsible Person</apex:facet>
                    <apex:outputField value="{!item.ResponsiblePTM__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">How</apex:facet>
                    <apex:outputField value="{!item.How__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">When</apex:facet>
                    <apex:outputField value="{!item.When__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Frequency</apex:facet>
                    <apex:outputField value="{!item.Frequency__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Generate Task</apex:facet>
                    <apex:outputField value="{!item.GenerateTask__c}" />
                </apex:column>
            </apex:pageBlockTable>
        </apex:pageBlockSection>
    </apex:pageBlock>
    
    <p style="page-break-after:always;"></p>
    <br/>
     <h2 style="line-height:80%;">Project Surveys</h2>
     <br/>
    <apex:pageBlock >
        <apex:pageBlockSection columns="1" collapsible="false">
            <apex:pageMessage severity="info" escape="false" summary="Project surveys measure the client’s overall satisfaction with AECOMs performance on a specific project. AECOM conducts monthly surveys on a 2% random sample of projects over 20% complete (of budget).   <br /><br />
Complete this section if the Project Manager wants to request a survey of the project, schedule a survey around a specific project event (e.g., completion of key milestone or deliverable) or schedule survey intervals for long term projects (e.g., annual survey).  The request will be provided to the Client Care Management team to action the project survey on the dates requested.   <br /><br />
Projects with no dates identified below will be automatically subjected to the random selection process. " />
            <apex:pageBlockTable value="{!lstSSW}" var="item" width="100%" columnsWidth="60px" id="SurveyScheduleTable">
                <apex:column >
                    <apex:facet name="header">Scheduled Date</apex:facet>
                    <apex:outputField value="{!item.ss.ScheduledDate__c}" />
                </apex:column>
                <apex:column >
                    <apex:facet name="header">Comments</apex:facet>
                    <apex:outputField value="{!item.ss.Comments__c}" style="width: 825px; height: 12px"/>
                </apex:column>
                <apex:column headerValue="Client">
                    <apex:outputField value="{!item.ss.Client__c}" />
                </apex:column>
                <apex:column headerValue="Contact">
                        <apex:outputField value="{!item.ss.Contact__c}" />
                        <span style="visibility: hidden;">
                        <apex:outputField value="{!item.ss.Site_Account__c}" />
                        </span>
                </apex:column>  
            </apex:pageBlockTable>
        </apex:pageBlockSection>
    </apex:pageBlock>
                    
    <p style="page-break-after:always;"></p>
    <br/>
     <h2 style="line-height:80%;">Project Location(s)</h2>
     <br/>                  
    <apex:pageBlock >
        <apex:pageBlockSection title="Selected Locations"  columns="1" collapsible="false">
            <apex:pageMessage severity="INFO" rendered="{!if(lstProjectCities.size > 0, false, true)}" summary="No Cities have been selected."></apex:pageMessage> 
            <apex:outputPanel >
            <apex:pageBlockTable value="{!lstProjectCities}" var="ProjectCity" rendered="{!if(lstProjectCities.size > 0, true, false)}">
                     <apex:column headerValue="Project Location" value="{!ProjectCity.CityName__c}" />
                     <apex:column headerValue="State/Province" value="{!ProjectCity.State_Name__c}" />
                     <apex:column headerValue="Country" value="{!ProjectCity.ProjectCountryRisk__r.CountryName__c}" />
                     <apex:column headerValue="Security Rating" value="{!ProjectCity.ProjectCountryRisk__r.Safety_Rating__c}" />
                     <apex:column headerValue="Business Risk" value="{!ProjectCity.ProjectCountryRisk__r.BusinessRisk__c}" />
                     <apex:column headerValue="Detention & Discrimination" value="{!ProjectCity.ProjectCountryRisk__r.DetentionDiscrimination__c}" />
                     <apex:column headerValue="Kidnap & Ransom" value="{!ProjectCity.ProjectCountryRisk__r.KidnapRansom__c}" />
                     <apex:column headerValue="Property" value="{!ProjectCity.ProjectCountryRisk__r.Property__c}" />
                     <apex:column value="{!ProjectCity.Type__c}" />
            </apex:pageBlockTable>
            <BR /><BR /><BR />
            <div style="text-align:center;font-size: 20px;font-weight: bold;padding:0 0 5px 10px;">
                <apex:outputLabel value="Project Location Risk: " />
                <apex:outputText value="{!projectRisk}" />
             </div>
             </apex:outputPanel>
        </apex:pageBlockSection>
    </apex:pageBlock>
                    
    <p style="page-break-after:always;"></p>
    <br/>                        
    <h2 style="line-height:80%;">Resilience Planning</h2>
    <br/>                           
    <apex:pageBlock >

        <apex:pageBlockSection title="Travel Security"  columns="1" collapsible="false" />

        <apex:pageMessage severity="INFO" rendered="{!if(lstProjectCities.size > 0, false, true)}" summary="Project Location must be selected to support resilience planning."></apex:pageMessage> 
        <apex:outputPanel rendered="{!if(lstProjectCities.size > 0, true, false)}">
            <apex:outputPanel rendered="{!AND(( projectRisk >= 0 ), ( projectRisk <= 1.9) )}">
                    Based on the country risk rating for this project, no further action is required when project team members book project travel.
            </apex:outputPanel>

            <apex:outputPanel rendered="{!AND(( projectRisk >= 2 ), ( projectRisk <= 2.9) )}">
                Based on the country risk rating, project team members are required to complete and submit Section 1.0 of the Travel Security Information Document prior to booking project travel.  Further information and guidance is available on the Global Resilience Group website.
                <BR /><BR />
            </apex:outputPanel>

            <apex:outputPanel rendered="{!projectRisk >= 3}">
                Based on the country risk rating, project team members are required to complete and submit Section 1.0, 2.0 and 3.0 (as applicable) of the Travel Security Information Document and receive concurrence from the Global Resilience Group prior to booking travel. Further information and guidance is available on the Global Resilience Group website.
            </apex:outputPanel>

            <apex:pageBlockSection title="Electronic Assets Security"  columns="1" collapsible="false" />
                <table><tr>
                <td class="questionCol">
                    <apex:outputText value="Will any AECOM employee be carrying or transporting AECOM-owned computer, network, other devices and/or electronics?"/>
                    </td>
                    <td>
                        <apex:outputField value="{!theProject.ResilienceElectronicAssets__c}" />
                    </td>
                </tr></table>       

            <apex:outputPanel rendered="{!theProject.ResilienceElectronicAssets__c == 'No'}">
                <BR /><BR />
                No further action is required.
            </apex:outputPanel>         

            <apex:outputPanel rendered="{!theProject.ResilienceElectronicAssets__c == 'Yes'}">
                <BR /><BR />
                Completion of Section 1.8 of the Operational Security Plan is required for review by the IT Information Security team and the Global Resilience Group.  Further information and guidance is available on the Global Resilience Group website.
                <BR /><BR />
            </apex:outputPanel>

            <apex:pageBlockSection title="Project Location Security"  columns="1" collapsible="false" />
            <apex:outputPanel rendered="{!AND(( projectRisk >= 0 ), ( projectRisk <= 1.9) )}">
                Based on the country risk rating for this project, the project team is required to complete and submit Section 1.0 of the Operational Security Plan.  Security requirements for the project can be reviewed in the Physical Resilience Standard.  Further information and guidance is available on the Global Resilience Group website.
                <BR /><BR />
            </apex:outputPanel>

            <apex:outputPanel rendered="{!AND(( projectRisk >= 2 ), ( projectRisk <= 2.9) )}">
                Based on the country risk rating for this project, the project team is required to complete the following documentation for review and approval by the Global Resilience Group:
                <BR /><BR />
                <ul>
                    <li>Project Pre-Bid Security Risk Assessment (opportunity phase)</li>
                    <li>Operational Security Plan (contracted phase; Sections 1.0 and 2.0 only)</li>
                </ul>
                <BR /><BR />
                Costs to complete the Operational Security Plan and implement identified security measures, security training, staff and/or materials should be estimated and included in AECOM’s proposal and Project Plan. 
                <BR /><BR />
                Further information and guidance is available on the Global Resilience Group website.  Security requirements can be viewed in the Physical Resilience and Country Security Standards.   
                <BR /><BR />
            </apex:outputPanel>

            <apex:outputPanel rendered="{!projectRisk >= 3}">
                Based on the country risk rating for this project, the project team is required to complete the following documentation for review and approval by the Global Resilience Group:
                <BR /><BR />
                <ul>
                    <li>Project Pre-Bid Security Risk Assessment (opportunity phase)</li>
                    <li>Operational Security Plan (contracted phase)</li>
                </ul>
                <BR /><BR />
                Costs to complete the Operational Security Plan and implement identified security measures, security training, staff and/or materials should be estimated and included in AECOM’s proposal and Project Plan. 
                <BR /><BR />
                Further information and guidance is available on the Global Resilience Group website.  Security requirements can be viewed in the Physical Resilience and Country Security Standards. 
                <BR /><BR />
                          
            </apex:outputPanel> 
        </apex:outputPanel>
    </apex:pageBlock>
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Safety, Health and Environment</h2>
    <br/>
    <apex:pageBlock >
        <apex:pageBlockSection title="Safety & Health" columns="1" id="safetyAndHealth">
            <apex:outputPanel id="safetyAndHealth1" >
            <apex:outputPanel >
            
            <table><tr>                         
            <td width="800px"><apex:outputText style="font-weight: bold;"><b><br/>Does the project consists of work outside of an office environment (e.g., field/construction work)?</b></apex:outputText></td>
            <td><apex:outputField value="{!theProject.SafetyHealthOutsideOfficeEnvironment__c}" /></td>
            </tr></table>
 
            </apex:outputPanel>
            
            <apex:outputPanel id="outsideOfficeEnvironment" rendered="{!theProject.SafetyHealthOutsideOfficeEnvironment__c =='Yes'}"> 
            <apex:outputPanel id="undertakeWork">   
                <table><tr>
                    <td width="800px">
                        <apex:outputText style="font-weight: bold;"><b><br/>Will members of the project team undertake work at project or client sites or offices?</b></apex:outputText>
                    </td>
                    <td><apex:outputField value="{!theProject.SafetyHealthUndertakeWork__c}" /></td>                    
                </tr></table>

                <apex:outputPanel rendered="{!theProject.SafetyHealthUndertakeWork__c == 'Yes'}">
                <div class="ouputPanelSep">
                    <div class="customHelpText" >
                        <div class="customHelpBody">
                            Project team members who will be working at the client or project offices may be required to undergo a safety induction(s) (i.e., site-specific training).  Click the “New Induction” button to create a register of all required inductions for the project.  Once each induction record has been created and added to the register, add the required project team member(s) and relevant document(s) by clicking “Add” within each record line.   Relevant documents may include application forms, induction location information or completed induction certificates.
                        </div>                                                                      
                    </div>
                    <br/>

                    <apex:outputPanel >

                        <apex:pageBlockTable value="{!inductionRegistrations}" var="induction" rendered="{!inductionRegistrations.size > 0}">

                            <apex:column headervalue="Name of Induction">
                                <apex:outputText value="{!induction.Name}"/>
                            </apex:column>
                            <apex:column headervalue="Required By" value="{!induction.RequiredBy__c}"></apex:column>
                            <apex:column headervalue="Project Team Members">
                                <table class="teamMemberGrid" width="100%">
                                <TR >

                                <TD style="border:none">
                                <table class="teamMemberGrid">
                                    <apex:repeat value="{!inductedProjectTeamMembersMap[induction.Id]}" var="inductionTeamMember">
                                    <tr><td style="border:none"><apex:outputText value="{!inductionTeamMember.TeamMember__c}"/></td></tr>
                                    </apex:repeat>
                                </table>
                                </TD>

                                </TR>
                                </table>
                            </apex:column>
                     
                            <apex:column headervalue="Location of Induction" value="{!induction.LocationofInduction__c}"></apex:column>
                            <apex:column headervalue="Frequency" value="{!induction.Frequency__c}" ></apex:column>
                            <apex:column headervalue="Fee">
                                <apex:outputtext value="{0, number, ###,###,##0.00}">
                                    <apex:param value="{!induction.Fee__c}" />
                                </apex:outputtext>  
                            </apex:column>               
                            <apex:column headervalue="Notes" value="{!induction.Notes__c}"></apex:column>
                            <apex:column headervalue="Attachments">
                                <table class="teamMemberGrid" width="100%">
                                <TR >

                                <TD style="border:none">
                                <table class="teamMemberGrid">
                                    <apex:repeat value="{!inductionAttachmentsMap[induction.Id]}" var="attachment">
                                    <tr><td style="border:none"><apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachment.Id)}" target="_blank"><apex:outputText value="{!attachment.Name}"/></apex:outputLink></td></tr>
                                    </apex:repeat>
                                </table>
                                </TD>

                                </TR>
                                </table>

                            </apex:column>          
                        </apex:pageBlockTable>
                    </apex:outputPanel> 
                <apex:outputPanel rendered="{!inductionRegistrations.size == 0}">
                    <apex:outputText value="No records to display"/>
                </apex:outputPanel><br/><br/>                                       
                </div></apex:outputPanel>
            </apex:outputPanel>
            
            <apex:outputPanel id="siteInspections">
            
            <apex:outputPanel rendered="{!theProject.SafetyHealthOutsideOfficeEnvironment__c =='Yes'}">
            
            <table><tr>
            <td width="800px"><apex:outputText ><b><br/>Does the project involve site inspections and/or field tasks?</b></apex:outputText></td>
            <td><apex:outputField value="{!theProject.SafetyHealthSiteInspections__c}" /></td>
            </tr></table>
                    
            <apex:outputPanel rendered="{!theProject.SafetyHealthSiteInspections__c=='Yes'}">

            <div class="ouputPanelSep">
                <div class="customHelpText" >
                    <div class="customHelpBody">
                        All field activities require a Task Risk Analysis to be undertaken. Complete the required analysis per your geography safety standard (e.g., Job Safety Analysis, Safe Work Method Statement, Task Hazard Analysis) and upload the completed documents for access and reference by the project team unless a project-specific
                         health and safety plan is prepared for the project.
                    </div>                                                                      
                </div>
                <br/>
                
                <div class="fileList">
                    <apex:pageBlockTable value="{!SafetyHealthInspectionFiles}" var="attachedSafetyInspectionFile" style="width: 825px;" rendered="{!theProject.SafetyHealthInspectionAttachments__c != null}">
                        <apex:column headerValue="File Name">
                            <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedSafetyInspectionFile.Id)}" target="_blank">
                                <apex:outputText value="{!attachedSafetyInspectionFile.Name}" />
                            </apex:outputLink>
                        </apex:column>
                        <apex:column value="{!attachedSafetyInspectionFile.ContentType}" /> 
                        <apex:column value="{!attachedSafetyInspectionFile.LastModifiedDate}" />    
                        <apex:column value="{!attachedSafetyInspectionFile.LastModifiedById}" />
                    </apex:pageBlockTable></div>
                    <apex:outputText value="{!overrideSafetyHealthInspectionName}" />
                    
                <br/></div></apex:outputPanel></apex:outputPanel>

            </apex:outputPanel>
            
            <apex:outputPanel id="healthRequirements">      
                <table><tr>
                    <td width="800px"><apex:outputText ><b><br/>Are there client specific safety and health requirements for this project?</b></apex:outputText></td>
                    <td><apex:outputField value="{!theProject.SafetyHealthSpecificRequirements__c}" /></td>
                </tr></table>
                <apex:outputPanel rendered="{!theProject.SafetyHealthSpecificRequirements__c == 'Yes'}">
                    <div class="ouputPanelSep">
                    <apex:outputText >Identify below any additional safety requirements which may apply to the project.</apex:outputText><br/>
                    <apex:outputField style="width: 800px;" value="{!theProject.SafetyHealthRequirementDescription__c}" html-placeholder="Reach out to Client Account Manager or Client Safety Lead for client specific safety and health requirements."/><br/><br/>
                    </div>
                </apex:outputPanel> 
            </apex:outputPanel>
            
            <apex:outputPanel id="healthPlan">  
            <table>
                <tr><td width="800px">                          
                    <apex:outputText ><b><br/>Is a detailed standalone project-specific health and safety plan required?</b></apex:outputText>
                </td>
                    <td>
                    <apex:outputField value="{!theProject.SafetyHealthSafetyPlan__c}" />
                    </td>
                </tr>
            </table>
            <apex:outputPanel rendered="{!theProject.SafetyHealthSafetyPlan__c =='Yes'}">
                <div class="ouputPanelSep">
                <apex:outputText >                                  
                Work directly with your regional SH{!'&'}E manager to compile the detailed safety plan and upload the signed and approved document.
                </apex:outputText><br/>
                <div class="fileList">
                    <apex:pageBlockTable value="{!SafetyHealthPlanFiles}" var="attachedSafetyPlanFile" style="width: 825px;" rendered="{!theProject.SafetyHealthPlanAttachments__c != null}">
                        <apex:column headerValue="File Name">
                            <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedSafetyPlanFile.Id)}" target="_blank">
                                <apex:outputText value="{!attachedSafetyPlanFile.Name}" />
                            </apex:outputLink>
                        </apex:column>
                        <apex:column value="{!attachedSafetyPlanFile.ContentType}" />   
                        <apex:column value="{!attachedSafetyPlanFile.LastModifiedDate}" />  
                        <apex:column value="{!attachedSafetyPlanFile.LastModifiedById}" />
                    </apex:pageBlockTable></div>
                    
                    <apex:outputText value="{!overrideSafetyHealthPlanName}" />
               
                <br/></div>
            </apex:outputPanel>
        
            </apex:outputPanel>
            
            <apex:outputPanel id="travelRequired">
            <apex:outputPanel > 
            <table><tr><td width="800px">
            <apex:outputText ><b><br/>Does the project require domestic travel to a remote or austere location, or international travel?</b></apex:outputText> 
            </td>
                <td><apex:outputField value="{!theProject.SafetyHealthTravelRequired__c}" /></td>
            </tr>
            </table>                                                                        
            </apex:outputPanel> <br/>
            <apex:outputPanel rendered="{!theProject.SafetyHealthTravelRequired__c =='Yes'}">
                <apex:outputText style="width: 500px">
                A Travel Security Identification Document (TSID) is required for international travel.  Go to the Locations and Resilience section for direction based on the project location. <br/>                                           
                Contact your local SH&amp;E Manager to determine if a Journey Management Plan is required for travel to remote or austere locations.
                </apex:outputText><br/><br/>
                </apex:outputPanel>
            </apex:outputPanel>
        </apex:outputPanel>
        </apex:outputPanel>                                                     
        </apex:pageBlockSection>
        
        <apex:pageBlockSection title="Environment" columns="1" id="environmentImpact">
            <apex:pageMessage severity="info"  escape="false"  summary="Where your region is certified to ISO 14001, Environmental Management, a Project Environmental Review must be completed.  Where your region is not certified, it is recommended that a Project Environmental Review is completed demonstrating AECOM’s commitment to work in an environmentally responsible manner. <br /><br />
In completing the Environmental Review within the Project Plan it is not intended that all of the ‘normal’ environmental impacts should be listed and commented on, but rather that any ‘unusual or particularly significant’ activities or requirements should be highlighted by exception and assessed."/>     

            To complete the Environmental Review:<br/><br/>
            <ul>
            <li>Subjectively rank the significance of each impact as high medium or low</li>
            <li>Note whether AECOM can either control or influence each identified potential impact</li>
            <li>For impacts that have been identified as being of high or medium significant and where AECOM can control or influence then, set out our proposed actions to manage these issues; and</li>
            <li>At each project review, update this assessment and note action taken (if applicable)</li>
            <li>If there are no environmental impacts, please note “none” to highlight that a review has been undertaken</li>
            </ul>


            <apex:outputPanel id="projectact">
                <apex:outputLabel style="font-weight: bold" value="List of Project Activities and Impacts"/>
                <apex:pageBlockTable value="{!ProjActivities}" var="PA">
                                   
                        <apex:column headervalue="Impact on the Environment">
                            <apex:outputField value="{!PA.ImpactonEnv__c}" />
                        </apex:column>
                        <apex:column headervalue="Significance">
                            <apex:outputField value="{!PA.Significance__c}" />
                        </apex:column>
                        <apex:column headervalue="Control">
                            <apex:outputField value="{!PA.Control__c}" />
                        </apex:column>
                        <apex:column headervalue="Proposed Action">
                            <apex:outputField value="{!PA.ProposedAction__c}" />
                        </apex:column>
                        <apex:column headervalue="Action Taken">
                            <apex:outputField value="{!PA.ActionTaken__c}" />                   
                        </apex:column>
                </apex:pageBlockTable>
                <br/><br/>
            </apex:outputPanel>                              
        
            <b>Additional Guidance </b><br /><br />
            The Project Environmental Review is compliant by:<br /><br />
            <ol type="a">
            <li>Identifying and assessing the environmental impacts relating to our projects and the services we provide;</li>
            <li>Using this assessment to assist in controlling significant environmental issues i.e. to adopt a proactive approach, and;</li>
            <li>Ensuring that we work within the framework of legislation and good practice guidelines.</li>
            </ol>
            The requirement to undertake environmental reviews is limited to our ability to influence or control the Environmental Impacts (either positive or negative) of a Project.  In turn our ability to influence or control is determined by our brief.
            The principles of Environmental Review are generic across the business, although the particular issues are likely to differ between Business Lines.  The following table identifies a range of typical environmental impacts related to construction projects.  It is not intended to be exhaustive.

            <br /><br />

            <div >
                <table class="infoTable" border="1" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>Emissions to Air</th>
                        <th>Releases to Water</th>
                    </tr>
                    <TR>
                        <TD>
                            <P>
                            <ul>
                                <li>Carbon dioxide emissions from energy use during building lifetime (global impact)</li>
                                <li>Green house gas depletion from refrigerants and insulants</li>
                                <li>NOx emissions from burners (global - leading to acid rain)</li>
                                <li>Indoor environment (local)</li>
                                <li>Release of hazardous materials to air (global and local)</li>
                                <li>During Construction – Dust, noise, light, VOC’s , Ash/Particulates, Litter, Steam, Methane</li>
                            </ul>
                            </P>
                        </TD>
                        <TD>
                            <P>
                            <ul>
                                <li>Contamination of ground water (global and local)</li>
                                <li>Contamination of surface water (global and local)</li>
                                <li>Storm water</li>
                                <li>Silt</li>
                                <li>Oil/Fuel Spillage</li>
                                <li>Chemicals</li>
                                <li>Hot Water (to natural rivers, ponds or other sensitive water courses)</li>
                                <li>Process Effluent</li>
                                <li>Fire Dowsing</li>
                                <li>Waste leaching</li>
                                <li>Sewage</li>
                                <li>Detergents</li>
                            </ul>
                            </P>
                        </TD>
                    </TR>   
                    <tr>
                        <th>Materials and Waste Management</th>
                        <th>Local Environment and Community Issues</th>
                    </tr>
                    <TR>
                        <TD>
                            <P>
                            <ul>
                                <li>Materials extraction, manufacture, use and transportation</li>
                                <li>Waste disposal - land use, transport etc (global and local)</li>
                                <li>Possible waste by-products (wood, concrete, brick/aggregates, plastic, metal, <br/> paper, batteries, electrical items, clinical, asbestos, copper, garden waste, fluorescent lights)</li>
                                <li>Managing / cleaning up contamination</li>
                                <li>Embodied energy, material selection, the use of recycled materials</li>                     
                            </ul>
                            </P>
                        </TD>
                        <TD>
                            <P>
                            <ul>
                                <li>Nuisance to neighbours (local impact)</li>
                                <li>Noise</li>
                                <li>Vibration</li>
                                <li>Dust</li>
                                <li>Light</li>
                                <li>Transport</li>
                                <li>Effect on local ecology (global and local)</li>
                                <li>Mud/litter on the road</li>
                                <li>Litter</li>
                                <li>Consequences of Population growth, positive (improvements in population, employment)</li>                 
                            </ul>
                            </P>
                        </TD>
                    </TR>                                                                                                                                                                                                                                                                                                                                                 
                </table>
            </div>
            </apex:pageBlockSection>        
    </apex:pageBlock>      

    <p style="page-break-after:always;"></p>
    <apex:pageBlock mode="edit" id="pageBlock" title="Document Management">
        <br/>
        <apex:pageBlockSection title="Guidance" collapsible="false" columns="1">
            Planning document management and control protocols to be utilized throughout the project inform the project team on the correct procedures to follow for all project documents, not just deliverables.  This ensures compliance with local AECOM procedures and/or contractual requirements mandated by the client.
            <br/><br/>Document management procedures typically fall within one of the following categories.  Complete this section of the Project Plan accordingly to summarize the required procedures for the project.
            <br/><br/>
            <li>Adopt standard AECOM processes throughout your project (click on the button below to adopt the AECOM standard) </li>
            <li>Adopt the standard process, though modified to suit client/project requirements (please outline the the variances to be implemented on this project. </li>
            <li>Adopt a client/project specific system, in which case outline the key features of the system and attach any documentation available (e.g. guidelines, user manuals etc).</li>
        </apex:pageBlockSection>
    
        <apex:pageBlockSection title="Document Management Element" collapsible="false" columns="2" id="dme" >
        <apex:outputPanel id="outputPanelDocumentControlSystem">
            <apex:outputText value="Document Control System" styleclass="dmeOutput"/><br/>      
            <apex:outputPanel id="panelDocumentControlSystem">
            <apex:outputField value="{!pse__Proj__c.DocumentControlSystem__c}" style="width: 825px; height: 40px;" rendered="{!pse__Proj__c.DocumentControlSystemType__c == null}"/>
            <apex:outputField value="{!pse__Proj__c.DocumentControlSystem__c}" style="width: 825px; height: 40px;" rendered="{!pse__Proj__c.DocumentControlSystemType__c == 'AECOM'}" html-placeholder="Enter the local AECOM system used for document control.  This may be a specific software  or simply the  local area network. Specialized procedures for technical deliverables, such as GIS or BIM file management, should be included as appropriate.  Attach any relevant document control or file management documents for reference."/>
            <apex:outputField value="{!pse__Proj__c.DocumentControlSystem__c}" style="width: 825px; height: 40px;" rendered="{!pse__Proj__c.DocumentControlSystemType__c == 'Client/Project'}" html-placeholder="Enter the project or client specific document control system, such as Projectwise , that may be part of our service offering or a project requirement for a secure data room to protect sensitive or confidential information.  Client or project reference documents may be attached for reference."/>
            </apex:outputPanel><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.DocumentControlSystemType__c}" /></td>
            </tr></table>   
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedDocumentControlSystemFiles}" var="attachedDocumentControlSystemFile" style="width: 825px;" rendered="{!pse__Proj__c.DocumentControlSystemAttachment__c != null}">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedDocumentControlSystemFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedDocumentControlSystemFile.Name}" />
                    </apex:outputLink>
                </apex:column>
                <apex:column value="{!attachedDocumentControlSystemFile.ContentType}" />    
                <apex:column value="{!attachedDocumentControlSystemFile.LastModifiedDate}" />   
                <apex:column value="{!attachedDocumentControlSystemFile.LastModifiedById}" />
            </apex:pageBlockTable>
            </div>          
        </apex:outputPanel>
        <apex:outputPanel ><br/></apex:outputPanel> 
        
        <apex:outputPanel id="outputDocumentNamingConventions" ><br/>
            <apex:outputText value="Document Naming Conventions" styleclass="dmeOutput"/><br/>
            <apex:outputPanel id="panelNameConventions">
            <apex:outputField value="{!pse__Proj__c.DocumentNamingConventions__c}" style="width: 825px; height: 40px" rendered="{!pse__Proj__c.DocumentNamingConventionsType__c == null}"/>             
            <apex:outputField value="{!pse__Proj__c.DocumentNamingConventions__c}" style="width: 825px; height: 40px" rendered="{!pse__Proj__c.DocumentNamingConventionsType__c == 'AECOM'}" html-placeholder="Enter the local AECOM  document naming conventions protocol. This could include conventions around version control (e.g., V1, Draft, Draft Final), as well as file naming conventions.  These  are likely defined by the local administrative team , technical practice or business line. Attach any relevant document control or file management documents for reference."/>            
            <apex:outputField value="{!pse__Proj__c.DocumentNamingConventions__c}" style="width: 825px; height: 40px" rendered="{!pse__Proj__c.DocumentNamingConventionsType__c == 'Client/Project'}" html-placeholder="Enter the project or client specific document naming conventions. This may be a requirement by your client or in your contract includes submittal of electronic deliverables or files. Client or project reference documents may be attached for reference"/>           
        </apex:outputPanel><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.DocumentNamingConventionsType__c}" /></td>
            </tr></table>                       
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedDocumentNamingConventionsFiles}" var="attachedDocumentNamingConventionFile" style="width: 825px;" rendered="{!pse__Proj__c.DocumentNamingConventionsAttachment__c != null}">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedDocumentNamingConventionFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedDocumentNamingConventionFile.Name}" />
                    </apex:outputLink>
                </apex:column>
                <apex:column value="{!attachedDocumentNamingConventionFile.ContentType}" /> 
                <apex:column value="{!attachedDocumentNamingConventionFile.LastModifiedDate}" />    
                <apex:column value="{!attachedDocumentNamingConventionFile.LastModifiedById}" />
            </apex:pageBlockTable></div>
        </apex:outputPanel>
        
        <apex:outputPanel ><br/>
    
        </apex:outputPanel>
        
        <apex:outputPanel ><br/>
            <apex:outputText value="File Management Structure" styleclass="dmeOutput"/><br/>
            <apex:outputPanel id="panelFileManagement">
            <apex:outputField id="inputFileManagement" value="{!pse__Proj__c.FileManagementStructure__c}" rendered="{!pse__Proj__c.FileManagementStructureType__c == null}" style="width: 825px; height: 40px"/>
            <apex:outputField id="inputFileManagementAECOM" value="{!pse__Proj__c.FileManagementStructure__c}" rendered="{!pse__Proj__c.FileManagementStructureType__c == 'AECOM'}" style="width: 825px; height: 40px" html-placeholder="Enter the local AECOM  file management structure.  This includes where and how electronic and hard copy documents are filed and maintained. These  are likely defined by your local IT department or administrative team but may be business line or practice area specific. Attach any relevant document control or file management documents for reference."/>
            <apex:outputField id="inputFileManagementOther" value="{!pse__Proj__c.FileManagementStructure__c}" rendered="{!pse__Proj__c.FileManagementStructureType__c == 'Client/Project'}" style="width: 825px; height: 40px" html-placeholder="Enter the project or client specific file management structure. This may be a requirement by your client or in your contract includes submittal of electronic deliverables or files. Client or project reference documents may be attached for reference."/>
            </apex:outputPanel><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.FileManagementStructureType__c}" />
                </td>
            </tr></table>               
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedFileManagementStructureFiles}" var="attachedFileManagmentStructureFile" style="width: 825px;" rendered="{!pse__Proj__c.FileManagementStructureAttachment__c != null}">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedFileManagmentStructureFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedFileManagmentStructureFile.Name}" />
                    </apex:outputLink>                  
                </apex:column>
                <apex:column value="{!attachedFileManagmentStructureFile.ContentType}" />   
                <apex:column value="{!attachedFileManagmentStructureFile.LastModifiedDate}" />  
                <apex:column value="{!attachedFileManagmentStructureFile.LastModifiedById}" />
            </apex:pageBlockTable></div>
        </apex:outputPanel>     
        <apex:outputPanel ><br/>
        </apex:outputPanel>
        
        <apex:outputPanel ><br/>
            <apex:outputText value="Document Transmittals" styleclass="dmeOutput"/><br/>
            <apex:outputPanel id="panelTransmittals">
            <apex:outputField id="inputTransmittals" value="{!pse__Proj__c.DocumentTransmittals__c}" rendered="{!pse__Proj__c.DocumentTransmittalsType__c == null}" style="width: 825px; height: 40px"/>
            <apex:outputField id="inputTransmittalsAECOM" value="{!pse__Proj__c.DocumentTransmittals__c}" rendered="{!pse__Proj__c.DocumentTransmittalsType__c == 'AECOM'}" style="width: 825px; height: 40px" html-placeholder="Enter the local AECOM document transmittals protocol. This could include how to track transmittals and/or the format the use of transmittal logs or cover sheets.  These are likely defined by your administrative team, business line or practice area. Attach any relevant document control or file management documents for reference."/>
            <apex:outputField id="inputTransmittalsOther" value="{!pse__Proj__c.DocumentTransmittals__c}" rendered="{!pse__Proj__c.DocumentTransmittalsType__c == 'Client/Project'}" style="width: 825px; height: 40px" html-placeholder="Enter the project or client specific document transmittals protocols.  This may be a requirement by your client or in your contract on how deliverables will be transmitted to the client or other stakeholders. Client or project reference documents may be attached for reference."/>
            </apex:outputPanel><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.DocumentTransmittalsType__c}" />
                </td>
            </tr></table>               
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedDocumentTransmittalsFiles}" var="attachedDocumentTransmittalsFile" style="width: 825px;" rendered="{!pse__Proj__c.DocumentTransmittalsAttachment__c != null }">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedDocumentTransmittalsFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedDocumentTransmittalsFile.Name}" />
                    </apex:outputLink>                      
                </apex:column>
                <apex:column value="{!attachedDocumentTransmittalsFile.ContentType}" /> 
                <apex:column value="{!attachedDocumentTransmittalsFile.LastModifiedDate}" />    
                <apex:column value="{!attachedDocumentTransmittalsFile.LastModifiedById}" />
            </apex:pageBlockTable></div>
        </apex:outputPanel>     
        
        <apex:outputPanel ><br/>
        </apex:outputPanel>
        
        <apex:outputPanel ><br/>
            <apex:outputPanel id="panelArchiving">
            <apex:outputText value="Document Records / Archiving" styleclass="dmeOutput"/><br/>     
            <apex:outputField id="inputArchiving" value="{!pse__Proj__c.DocumentRecordsArchiving__c}" rendered="{!pse__Proj__c.DocumentRecordsArchivingType__c == null}" style="width: 825px; height: 40px"/>
            <apex:outputField id="inputArchivingAECOM" value="{!pse__Proj__c.DocumentRecordsArchiving__c}" rendered="{!pse__Proj__c.DocumentRecordsArchivingType__c == 'AECOM'}" style="width: 825px; height: 40px" html-placeholder="Enter the local AECOM record retention or archiving protocol. This includes the location (on site or off site) and archive duration. These are likely defined by your administrative team, business line or practice area. Attach any relevant document control or file management documents, such as directions on how to request document archiving services, for reference."/>
            <apex:outputField id="inputArchivingOther" value="{!pse__Proj__c.DocumentRecordsArchiving__c}" rendered="{!pse__Proj__c.DocumentRecordsArchivingType__c == 'Client/Project'}" style="width: 825px; height: 40px" html-placeholder="Enter the project or client specific record retention or archiving protocol.  This may be a requirement by your client or in your contract on how long project documents and deliverables must be archived. Client or project reference documents may be attached for reference."/>
            </apex:outputPanel><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.DocumentRecordsArchivingType__c}" />
                </td>
            </tr></table>                           
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedDocumentRecordsAndArchivingFiles}" var="attachedDocumentRecordsArchivingFile" style="width: 825px;" rendered="{!pse__Proj__c.DocumentRecordsArchivingAttachment__c != null}">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedDocumentRecordsArchivingFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedDocumentRecordsArchivingFile.Name}" />
                    </apex:outputLink>  
                </apex:column>
                <apex:column value="{!attachedDocumentRecordsArchivingFile.ContentType}" /> 
                <apex:column value="{!attachedDocumentRecordsArchivingFile.LastModifiedDate}" />    
                <apex:column value="{!attachedDocumentRecordsArchivingFile.LastModifiedById}" />
            </apex:pageBlockTable></div>
        </apex:outputPanel> 
        <apex:outputPanel ><br/></apex:outputPanel>
                
        <apex:outputPanel ><br/>
            <apex:outputText value="Document Other Comments / Notes" styleclass="dmeOutput"/><br/>      
            <apex:outputField id="inputComments" value="{!pse__Proj__c.DocumentOtherCommentsNotes__c}" style="width: 825px; height: 40px"/><br/>
            <table><tr>
            <td class="questionCol">
                <apex:outputText value="Will standard AECOM or client/project-specific document management and control protocols be utilized for the project?"/>
                </td>
                <td><apex:outputField value="{!pse__Proj__c.DocumentOtherCommentsNotesType__c}" />
                </td>
            </tr></table>   
            <div class="fileList">
            <apex:pageBlockTable value="{!AttachedDocumentCommentsOtherNotesFiles}" var="attachedDocumentCommentsOtherNotesFile" style="width: 825px;" rendered="{!pse__Proj__c.DocumentOtherCommentsNotesAttachment__c != null}">
                <apex:column headerValue="File Name">
                    <apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedDocumentCommentsOtherNotesFile.Id)}" target="_blank">
                        <apex:outputText value="{!attachedDocumentCommentsOtherNotesFile.Name}" />
                    </apex:outputLink>  
                </apex:column>
                <apex:column value="{!attachedDocumentCommentsOtherNotesFile.ContentType}" />   
                <apex:column value="{!attachedDocumentCommentsOtherNotesFile.LastModifiedDate}" />  
                <apex:column value="{!attachedDocumentCommentsOtherNotesFile.LastModifiedById}" />
            </apex:pageBlockTable></div>
        </apex:outputPanel>         
    
        
        </apex:pageBlockSection>
    
    </apex:pageBlock>
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Risk Management</h2>
    <br/>
    <apex:pageBlock >
        <apex:pageBlockSection title="Project Risks" columns="1" collapsible="false">
            <apex:pageBlockTable value="{!Risks}" rendered="{!Risks.size > 0}" var="risklist" rowClasses="even,odd">
                <apex:column headerValue="Action">
                    <apex:outputLink value="/{!risklist.Id}" id="theLink">View</apex:outputLink>&nbsp;&nbsp;
                </apex:column>
                <apex:column headerClass="centerAlign" styleClass="leftAlign"><apex:facet name="header">Risk Title</apex:facet><apex:outputField value="{!risklist.Name}"/></apex:column>
                <apex:column headerClass="centerAlign" headerValue="Current Status" styleClass="centerAlign"><apex:outputField value="{!risklist.CurrentStatus__c}"/></apex:column>
                <apex:column headerClass="centerAlign" headerValue="Event Phase" styleClass="centerAlign"><apex:outputField value="{!risklist.EventPhase__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign" headerValue="Risk Owner"><apex:outputField value="{!risklist.RiskOwner__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign"><apex:facet name="header">Pre-mitigation<br/>Rating</apex:facet><apex:outputField value="{!risklist.Premitigationrating__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="rightAlign"><apex:facet name="header">Pre-mitigation<br/>Contingency</apex:facet>
                <apex:outputtext value="{0, number, currency}">
                   <apex:param value="{!risklist.ContingencyDollars__c}" />
                </apex:outputtext>                
                </apex:column>                      
                
                <apex:column headerClass="centerAlign" styleClass="leftAlign" headerValue="Mitigation Strategy"><apex:outputField value="{!risklist.RiskMitigation__c}"/></apex:column>
                <apex:column headerClass="centerAlign" styleClass="rightAlign"><apex:facet name="header">Mitigation<br/>Cost Total</apex:facet>
                <apex:outputtext value="{0, number, currency}">
                   <apex:param value="{!risklist.MitigationCostTotal__c}" />
                </apex:outputtext>                     
                </apex:column>
                <apex:column headerClass="centerAlign" styleClass="centerAlign"><apex:facet name="header">Post-mitigation<br/>Rating</apex:facet>
                    <apex:outputField value="{!risklist.Postmitigationrating__c}"/>                
                </apex:column>  
                <apex:column headerClass="centerAlign" styleClass="rightAlign"><apex:facet name="header">Post-mitigation<br/>Contingency Total</apex:facet>
                <apex:outputtext value="{0, number, currency}">
                   <apex:param value="{!risklist.PostmitigationContingencyTotal__c}" />
                </apex:outputtext>                     
                </apex:column>
            </apex:pageBlockTable>
            
            <apex:outputPanel rendered="{!Risks.size == 0}">
                <apex:outputText value="No records to display"/>
            </apex:outputPanel> 
        </apex:pageBlockSection>
    </apex:pageBlock>
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Assumptions Register</h2>
    <br/>
    <apex:pageBlock id="assumptionRegister" title="Project Assumption List" >
    <br/>
        <table class="tablesorter" cellspacing="0" cellpadding="0">
            <thead>
                <tr>
                    <th width="160px">
                        Plan Element
                    </th>
                    <th>
                        Assumption
                    </th>
                </tr>
            </thead>
            <tbody>
                <apex:repeat value="{!lAssumptions}" var="assumption">
                    <tr class="firstRow">
                        <td>
                            <apex:outputField value="{!assumption.PlanElement__c}" />
                        </td>
                        <td>
                            <apex:outputField value="{!assumption.Assumption__c}" />
                        </td>
                    </tr>
                </apex:repeat>
            </tbody>
        </table>
    </apex:pageBlock>

    <p style="page-break-after:always;"></p>
    <br/>   
    <br/>
    <h2 style="line-height:80%;">DOA Register and Conditions of Approval</h2>
    <br/>
    <apex:pageBlock >
        <apex:pageBlockSection title="DOA Triggers" collapsible="false">
            <apex:pageBlockTable value="{!lstDOATriggers}" var="Trigger" rendered="{!if(lstDOATriggers.size > 0, true, false)}" id="TriggerTable">
            <apex:column headerValue="Select"  width="40" id="selectBox" >
                <apex:outputText value="{!Trigger.bChecked}" />
            </apex:column>
            <apex:repeat value="{!$ObjectType.DOARegister__c.FieldSets.DOA_TriggerView}" var="SearchField">
                <apex:column value="{!Trigger.oTrigger[SearchField]}" />
            </apex:repeat>
            </apex:pageBlockTable>
        </apex:pageBlockSection>
        <apex:pageBlockSection title="Conditions of Approval" collapsible="false">
            <apex:pageMessage severity="INFO" rendered="{!if(lstDOAConditions.size > 0, false, true)}" summary="No DOA Conditions Found"></apex:pageMessage> 
            <apex:pageBlockTable value="{!lstDOAConditions}" var="Condition" rendered="{!if(lstDOAConditions.size > 0, true, false)}">
                <apex:column headerValue="View"  width="40">
                    <apex:outputLink value="/{!Condition.id}">View</apex:outputLink>
                </apex:column>              
                <apex:repeat value="{!$ObjectType.DOAConditions__c.FieldSets.DOA_ApprovalView}" var="SearchField">
                    <apex:column value="{!Condition[SearchField]}" />
                </apex:repeat>
            </apex:pageBlockTable>
        </apex:pageBlockSection>
        
    </apex:pageBlock>
    
    <p style="page-break-after:always;"></p>
    <br/>
    <h2 style="line-height:80%;">Change Management</h2>
    <br/>    
    <apex:pageBlock >                                                                        
              <apex:pageBlockSection title="Project Contract Change Requirements" collapsible="false" columns="1">
                <apex:outputPanel >
                    <apex:outputLabel value="AECOM Requirements" styleClass="dmeOutput"/>
                    <c:ECO_HelpIcon helpText="{!$ObjectType.pse__Proj__c.fields.ChangeManagerAECOMRequirements__c.inlineHelpText}" />
                    <br />
                    <apex:outputField value="{!pse__Proj__c.ChangeManagerAECOMRequirements__c}" style="width: 825px; height: 40px" html-placeholder="For example, review DOA triggers or conditions of contractual approval."/>
                </apex:outputPanel>
                <apex:outputPanel >
                <apex:outputLabel value="Clients Requirements" styleClass="dmeOutput"/>
                <c:ECO_HelpIcon helpText="{!$ObjectType.pse__Proj__c.fields.ChangeManagerClientsRequirements__c.inlineHelpText}" />
                <br/>
                    <apex:outputField value="{!pse__Proj__c.ChangeManagerClientsRequirements__c}" style="width: 825px; height: 40px" html-placeholder="For example, when proposing a new project team member provide a copy of their resume to the client project manager for approval prior to the individual beginning work on the project." />
                </apex:outputPanel>
            </apex:pageBlockSection>
            <apex:pageBlockSection columns="1">
                <apex:outputPanel >
                    <apex:outputLabel styleclass="dmeOutput" value="Change Legend"/>
                    <table class="changeManagerTable">
                        <tr><td><apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}"/><apex:outputLabel styleclass="dmeOutput" value=" No Unapproved Changes"/></td></tr>
                        <tr><td><apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}"/><apex:outputLabel styleclass="dmeOutput" value="Changes Pending Approval"/></td></tr>
                    </table>
                    <br/>
                    <apex:outputLabel styleclass="dmeOutput" value="Project Plan Change Status"/>
                    <table class="changeManagerTable">
                        <tr>                        
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedTasks)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}"/>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedTasks}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}"/>
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Schedule/WBS"/>
                            </td>
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedKeyMembers)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedKeyMembers}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Project Team"/>
                            </td>
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedCustomers)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedCustomers}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Customers"/>
                            </td>
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedClassifications)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedClassifications}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Project Classifications"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedSHE)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedSHE}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Safety Health & Environment"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedAgreements)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedAgreements}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Agreements and Funding"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedScope)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedScope}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Scope and Packages"/>
                            </td>   
                        </tr>
                        <tr>                    
                            <!-- <td><apex:outputLabel styleclass="dmeOutput" value="Budget"/></td>      -->                
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedResources)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedResources}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Subs and Vendors"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedDeliverables)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedDeliverables}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Deliverables"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedDocManage)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedDocManage}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Document Management"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedStakeComm)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedStakeComm}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Stakeholders & Communications"/>
                            </td>                       
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedRisk)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedRisk}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Risk Register"/>
                            </td>
                            <td>
                                <apex:outputPanel rendered="{!NOT(IsChangedResilience)}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerNoChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!IsChangedResilience}">
                                    <apex:outputField value="{!pse__Proj__c.ChangeManagerChanges__c}" />
                                </apex:outputPanel>
                                <apex:outputLabel styleclass="dmeOutput" value="Resilience"/>
                            </td>
                        </tr>               
                    </table>    
                </apex:outputPanel>
                                                        
            </apex:pageBlockSection>    
        </apex:pageBlock>
        
        <p style="page-break-after:always;"></p>
        <br/>
        <h2 style="line-height:80%;">Project Finances</h2>
        <br/> 
        <br/>
        <br/>
        <h3 style="line-height:80%;">Summary of Agreements</h3>
        <br/>    
        <apex:pageBlock >
                <apex:pageBlockTable rendered="{!lAgreements.size > 0}" value="{!lAgreements}" var="eachAgmnt">
                    <apex:column value="{!eachAgmnt.Name}"/>
                    <apex:column value="{!eachAgmnt.Project__r.Name}"/>
                    <apex:column value="{!eachAgmnt.RecordType.Name}"/>
                    <apex:column value="{!eachAgmnt.Description__c}"/>
                    <apex:column value="{!eachAgmnt.Amount__c}"/>
                    <apex:column value="{!eachAgmnt.Account__c}"/>
                </apex:pageBlockTable>
        </apex:pageBlock>
 
        <p style="page-break-after:always;"></p>
        <br/>
        <h2 style="line-height:80%;">Prime Agreements and Funding</h2>
        <br/> 
        <br/> 
        
        <apex:repeat rendered="{!lPrimeAgreements.size > 0}" value="{!lPrimeAgreements}" var="agreement">
            
            <apex:pageBlock title="{!agreement.Name} - {!agreement.RecordType.Name}">
            <br/> 
            <apex:pageBlockSection >
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Name.inlineHelpText}">
                    <apex:outputText value="ECO Agreement Number"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.Name}" />
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Ecosystem Project Reference ID"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.project__r.EcoSystemReferenceNumber__c}" />              
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Agreement Status"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.AgreementStatus__c}" />    
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Oracle Project No"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.project__r.OracleProjectnumber__c}" />
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementNumber__c.inlineHelpText}">
                    <apex:outputText value="Oracle Agreement No"/>
                     <apex:outputPanel >
                    <apex:outputField value="{!agreement.AgreementNumber__c}" />
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Project Name"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.project__r.Name}"  />
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ParentAgreement__c.inlineHelpText}">
                    <apex:outputText value="Parent Agreement"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ParentAgreement__c}" />        
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>            
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProjectTeamMember__c.inlineHelpText}">
                    <apex:outputText value="Agreement Owner"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ProjectTeamMember__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Billing Client"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.Account__c}" />    
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementExecutedBy__c.inlineHelpText}">
                    <apex:outputText value="Agreement Executed By"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.AgreementExecutedBy__c}" />    
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.InvoicingClient__c.inlineHelpText}">
                    <apex:outputText value="Invoicing Client"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.InvoicingClient__c}" />        
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExecutionDate__c.inlineHelpText}">
                    <apex:outputText value="Execution Date"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ExecutionDate__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ContractTitle__c.inlineHelpText}">
                    <apex:outputText value="Contract Title/Name"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ContractTitle__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FeeType__c.inlineHelpText}">
                    <apex:outputText value="Fee Type"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.FeeType__c}" />        
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>            
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ClientContractReferenceNo__c.inlineHelpText}">
                    <apex:outputText value="Client Contract Reference No."/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ClientContractReferenceNo__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>            
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Payment Terms"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.PaymentTerms__c}" />
                    </apex:outputPanel>             
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Contract Type"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.AgreementType__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>            
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.FundingCurrencyCode__c.inlineHelpText}">
                    <apex:outputText value="Agreement Currency"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.FundingCurrencyCode__c}" />    
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="The date the agreement record was created in Ecosystem (& Oracle)">
                    <apex:outputText value="Create Date"/>
                    <apex:outputField value="{!agreement.CreatedDate}"/>                
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.Amount__c.inlineHelpText}">
                    <apex:outputText value="Agreement Amount (confirmed)"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.Amount__c}" /> 
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.StartDate__c.inlineHelpText}">
                    <apex:outputText value="Start Date"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.StartDate__c}" />  
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>                                            
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.AgreementAmountEstimated__c.inlineHelpText}">
                    <apex:outputText value="Agreement Amount (estimated)"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.AgreementAmountEstimated__c}" />
                    </apex:outputPanel>             
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ExpirationDate__c.inlineHelpText}">
                    <apex:outputText value="End Date"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ExpirationDate__c}" /> 
                    </apex:outputPanel>                         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Total Funding Amount"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.TotalFundingAmount__c}" /> 
                    </apex:outputPanel>         
                </apex:pageBlockSectionItem>        
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ProfIndemnityLiabilityAmt__c.inlineHelpText}">
                    <apex:outputText value="Prof Indemnity/Liability Amt"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ProfIndemnityLiabilityAmt__c}" />
                    </apex:outputPanel>                                         
                </apex:pageBlockSectionItem>    
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Agreement - Funding Variance"/>
                    <apex:outputField value="{!agreement.AgreementFundingVariance__c}"/>                
                </apex:pageBlockSectionItem>            
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.PublicGeneralLiabilityAmt__c.inlineHelpText}">
                    <apex:outputText value="Public/General Liability Amt"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.PublicGeneralLiabilityAmt__c}" />      
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                        <apex:outputText value="Variance Reason"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!agreement.VarianceReason__c}" /> 
                        </apex:outputPanel>                                                 
                </apex:pageBlockSectionItem>   
                     
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Revenue Limit"/>
                    <apex:outputPanel >
                            <apex:outputField value="{!agreement.RevenueLimitFlag__c}" />                 
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>    
                
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Action Code"/>
                    <apex:outputPanel >
                    <apex:outputField value="{!agreement.ActionCode__c}"  />   
                    </apex:outputPanel>                        
                </apex:pageBlockSectionItem>
                    
                <apex:pageBlockSectionItem >
                    <apex:outputText value="Invoice Limit"/>
                    <apex:outputPanel >
                            <apex:outputField value="{!agreement.InvoiceLimitFlag__c}" />                 
                    </apex:outputPanel>     
                </apex:pageBlockSectionItem>    
    
                <apex:pageBlockSectionItem >    
                    <apex:outputText value="Change Manager Approved For Synch"/>  
                   <apex:outputPanel >          
                        <apex:outputField value="{!agreement.ChangeManagerApprovedForSynch__c}"  />  
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem >    
                    <apex:outputText value="Change Manager Is Changed"/>      
                    <apex:outputPanel >      
                        <apex:outputField value="{!agreement.ChangeManagerIsChanged__c}"  />  
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                                                                                                                                       
            </apex:pageBlockSection>
            
            <apex:pageBlockSection columns="2">
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopePackage__c.inlineHelpText}">
                    <apex:outputText value="Scope Package"/>
                    <apex:outputPanel >
                        <apex:outputField value="{!agreement.ScopePackage__c}" />
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>    
                    
                <apex:pageBlockSectionItem helptext="{!$ObjectType.Agreement__c.Fields.ScopeOfServices__c.inlineHelpText}">
                    <apex:outputText value="Scope of Services"/>
                    <apex:outputPanel id="primeScope">
                        <apex:outputField value="{!agreement.ScopeOfServices__c}" rendered="{!agreement.ScopePackage__c == null}"/>
                        <apex:outputField value="{!agreement.ScopePackage__r.Scope_Details__c}" rendered="{!agreement.ScopePackage__c != null}"/>
                    </apex:outputPanel>             
                </apex:pageBlockSectionItem>    
            </apex:pageBlockSection>        
            </apex:pageBlock>
            
            <apex:variable var="primeAgmntId" value="{!agreement.Id}" />
            
             <!--
            <apex:outputText value="Current Prime Agmnt ID: {!primeAgmntId}" />
            <apex:repeat value="{!mapOfPrimeAgmntIdToFundings}" var="keyAgmntId">
                <apex:outputText value="Prime Agreement ID: {!keyAgmntId}" />
                <apex:pageBlock title="Funding" >
                <apex:outputPanel >
                    <apex:pageBlockTable value="{!mapOfPrimeAgmntIdToFundings[keyAgmntId]}" var="funding">
                        <apex:column headervalue="Date Allocated">
                            <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                                    <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                                </apex:column>                  
                                <apex:column headervalue="Allocated Amount">
                                    <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                                    <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                                </apex:column>
                    </apex:pageBlockTable>
                </apex:outputPanel>
                </apex:pageBlock>
            </apex:repeat>
            -->
        
            <apex:variable var="listOfFundingsForPrimeAgmnt" value="{!mapOfPrimeAgmntIdToFundings[primeAgmntId]}" />
            <apex:outputPanel rendered="{!listOfFundingsForPrimeAgmnt.size > 0}">
                <apex:pageBlock title="Funding" >
                <br/>
                    <apex:outputPanel >
                    
                        <apex:pageBlockTable value="{!listOfFundingsForPrimeAgmnt}" var="funding">
                            <apex:column headervalue="Date Allocated">
                                <apex:outputField value="{!funding.CreatedDate}" rendered="{!funding.DateAllocatedDate__c == null}"></apex:outputField>
                                <apex:outputField value="{!funding.DateAllocatedDate__c}" rendered="{!funding.DateAllocatedDate__c != null}"></apex:outputField>                    
                            </apex:column>                  
                            <apex:column headervalue="Allocated Amount">
                                <apex:outputField value="{!funding.TotalBaselinedAmount__c}" rendered="{!funding.AllocatedAmount__c==null}"/>
                                <apex:outputField value="{!funding.AllocatedAmount__c}" rendered="{!funding.AllocatedAmount__c!=null}"/>
                            </apex:column>
                        </apex:pageBlockTable> 
                      
                    </apex:outputPanel>
                </apex:pageBlock>
            </apex:outputPanel>
                 
                   
            <apex:outputPanel rendered="{!listOfFundingsForPrimeAgmnt.size == 0}">
            	<apex:pageBlock title="Funding" >
	                <br/>
	                <apex:outputText value="No records to display"/>
	                <br/>
                </apex:pageBlock>
            </apex:outputPanel> 
            <p style="page-break-after:always;"></p>
        </apex:repeat>      
        
        <h2 style="line-height:80%;">Budget and Billing Details</h2>
        <br/> 
        <br/> 
        
        <apex:pageBlock id="theBlock">
            <apex:pageBlockSection id="budgetHeaderSummary" title="Budget Header Summary" columns="1" collapsible="false">
                <apex:form styleClass="budgetFrameWrapper">
                <table style="width:100%">
                <tr>
                    <th style="border: 0px"></th>
                    <th style="border: 0px"></th>
                    <th style="border: 0px"></th>
                    <th colspan="2" class="centerBlue">CHANGE VALUE</th>
                    <th colspan="2" class="centerGreen">BUDGET / AS-SOLD</th>
                    <th colspan="2" class="centerPurple">FORECAST / EAC</th>
                    <th colspan="2" class="centerOrange">WORK AT RISK</th>
                </tr>
                <tr>
                    <th style="background-color:#ACACA8">Budget Name</th>
                    <th style="background-color:#ACACA8">Created Date</th>
                    <th style="background-color:#ACACA8">Status</th>
                    <th class="rightBlue">Cost</th>
                    <th class="rightBlue">Revenue</th>
                    <th class="rightGreen">Approved Cost</th>
                    <th class="rightGreen">Approved Revenue</th>
                    <th class="rightPurple">Forecast Cost</th>
                    <th class="rightPurple">Forecast Revenue</th>
                    <th class="rightOrange">WaR - Cost</th>
                    <th class="rightOrange">War - Revenue</th>
                </tr>
                <apex:repeat value="{!budgetWrapper.dtoBudgetHeaders}" var="budgetHeader">
                    <tr>
                        <td>{!budgetHeader.budgetName}</td>
                        <td>
                            <apex:outputText value="{0,date,d MMM yyyy}">
                                <apex:param value="{!budgetHeader.createdDate}" /> 
                            </apex:outputText>
                        </td>
                        <td>{!budgetHeader.status}</td>
                        <td class="dollarAmount lightBlue">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalCost}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightBlue">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalRevenue}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightGreen">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalApprovedCost}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightGreen">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalApprovedRevenue}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightPurple">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalForecastCost}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightPurple">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalForecastRevenue}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightOrange">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalWorkAtRiskCost}" />
                            </apex:outputText>
                        </td>
                        <td class="dollarAmount lightOrange">
                            <apex:outputText value="{0, number, ###,###,###,##0.00}">
                                <apex:param value="{!budgetHeader.dTotalWorkAtRiskRevenue}" />
                            </apex:outputText>
                        </td>
                    </tr>
                </apex:repeat>
                <tr>
                    <td style="height:30px;border-right: 0px solid #fff !important; border-left: 0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="12"></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">Raw Labour</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalRawLabour}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalRawLabour}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalRawLabour}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">Fringe</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalFringe}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalFringe}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalFringe}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">Overhead</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalOverhead}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalOverhead}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalOverhead}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">Subs</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalSubAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalSubAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalSubAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">ODCs</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalFeeAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalFeeAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalFeeAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount">Contingency</td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalContingencyAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalContingencyAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                    <td class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalContingencyAmount}" />
                        </apex:outputText>
                    </td>
                    <td></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="dollarAmount bold">Current Budget total</td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalCost}" />
                        </apex:outputText>
                    </td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalRevenue}" />
                        </apex:outputText>
                    </td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalCost}" />
                        </apex:outputText>
                    </td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalRevenue}" />
                        </apex:outputText>
                    </td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalCost}" />
                        </apex:outputText>
                    </td>
                    <td class="dollarAmount bold">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalRevenue}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td style="height:30px;border-right: 0px solid #fff !important; border-left: 0px solid #fff !important;border-bottom:0px solid #fff !important;border-top:0px solid #fff !important;" colspan="12"></td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">BUDGET METRICS</td>
                    <td colspan="2" class="centerGreen">BUDGET / AS - SOLD</td>
                    <td colspan="2" class="centerPurple">FORECAST / EAC</td>
                    <td colspan="2" class="centerOrange">WORK AT RISK</td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">Net Service Revenue</td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalNetServiceRevenue}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalNetServiceRevenue}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalNetServiceRevenue}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">Gross Margin</td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalGrossMargin}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalGrossMargin}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalGrossMargin}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">Net Margin</td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getBudgetTotalNetMargin}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getForecastTotalNetMargin}" />
                        </apex:outputText>
                    </td>
                    <td colspan="2" class="dollarAmount">
                        <apex:outputText value="{0, number, ###,###,###,##0.00}">
                            <apex:param value="{!budgetWrapper.getWorkAtRiskTotalNetMargin}" />
                        </apex:outputText>
                    </td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">GM/NSR</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getBudgetTotalGMNSR}%</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getForecastTotalGMNSR}%</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getWorkAtRiskTotalGMNSR}%</td>
                </tr>
                <tr>
                    <td style="border-right: 0px solid #fff !important;border-left: 0px solid #fff !important;border-top:0px solid #fff !important;border-bottom:0px solid #fff !important;" colspan="4"></td>
                    <td class="rightBlue">NM/NSR</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getBudgetTotalNMNSR}%</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getForecastTotalNMNSR}%</td>
                    <td colspan="2" class="percentAmount">{!budgetWrapper.getWorkAtRiskTotalNMNSR}%</td>
                </tr>
                </table>
                </apex:form>
            </apex:pageBlockSection>
            
			<apex:pageBlockSection id="projectInfo" title="Project Info" columns="2" collapsible="false">
				<apex:pageBlockSectionItem >
					<apex:outputLabel value="Budget Levels - Cost" />
					<apex:outputField value="{!theProject.BudgetStrategy__c}"  />
				</apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
					<apex:outputLabel value="Budget Levels - Revenue" />
					<apex:outputField value="{!theProject.BudgetStrategyRevenue__c}"  />
				</apex:pageBlockSectionItem>
				<apex:pageBlockSectionItem >
					<apex:outputPanel layout="inline">
						<apex:outputField value="{!theProject.BudgetOffline__c}" />
						<apex:outputLabel value="This project is offline." />
					</apex:outputPanel>
				</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
			
			<apex:pageBlockSection title="Fee Basis" collapsible="false" columns="1" id="escalationSection">
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="Commercial Structure" />
							<apex:outputField value="{!theProject.DefaultMarginType__c}" />
						</apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem rendered="{!theProject.DefaultMarginType__c == 'Amount'}">
							<apex:outputLabel value="Default Bill Rate" />
							<apex:outputField value="{!theProject.DefaultBillRate__c}"/>
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem rendered="{!theProject.DefaultMarginType__c == 'Percent'}">
							<apex:outputLabel value="Default Labour %age" />
							<apex:outputField value="{!theProject.DefaultUpliftLabor__c}" />
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem rendered="{!theProject.DefaultMarginType__c == 'Percent'}">
							<apex:outputLabel value="Default subs %age" />
							<apex:outputField value="{!theProject.DefaultUpliftSubs__c}" />
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem rendered="{!theProject.DefaultMarginType__c == 'Percent'}">
							<apex:outputLabel value="Default ODC %age" />
							<apex:outputField value="{!theProject.DefaultUpliftODCs__c}" />
						</apex:pageBlockSectionItem>
						<apex:pageBlockSectionItem >
							<apex:outputLabel value="Escalation Applies" />
							<apex:outputField value="{!theProject.EscalationApplies__c}" />
						</apex:pageBlockSectionItem>
			</apex:pageBlockSection>
			
			<apex:pageBlockSection id="taskSection" columns="1">
                    	<apex:pageBlockSectionItem rendered="{!theProject.EscalationApplies__c}" >
                            <apex:pageBlockTable value="{!tasks}" var="taskNumber" id="taskTable">
                                <apex:column >
                                    <apex:facet name="header">
                                        Date Effective
                                    </apex:facet>
                                    <apex:outputField value="{!tasks[taskNumber].ActivityDate}"  />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Description
                                    </apex:facet>
                                    <apex:outputField value="{!tasks[taskNumber].Description}" />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Assigned To
                                    </apex:facet>
                                    <apex:outputField value="{!tasks[taskNumber].OwnerId}" />
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            	
            <apex:pageBlockSection title="Cash Flow" collapsible="false" columns="1" id="milestoneSection" >
					<apex:pageBlockSectionItem >
						<apex:outputLabel value="Payment Terms" for="paymentTerms" />
						<apex:outputField value="{!theProject.PaymentTerms__c}" id="paymentTerms"/>
					</apex:pageBlockSectionItem>
					<apex:pageBlockSectionItem >
						<apex:outputLabel value="Billing Structure" />
						<apex:outputField value="{!theProject.BillingStructure__c}" />
					</apex:pageBlockSectionItem>
                        <apex:pageBlockSection columns="1" rendered="{!theProject.BillingStructure__c == 'Progress'}">
                        	<apex:pageBlockSectionItem >
                                <apex:outputLabel value="Frequency" />
                                <apex:outputField value="{!theProject.MilestoneFrequency__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Project Start Date" />
                                <apex:outputField value="{!theProject.pse__Start_Date__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Project End Date" />
                                <apex:outputField value="{!theProject.pse__End_Date__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="First Invoice date" />
                                <apex:outputField value="{!theProject.DateOfFirstInvoice__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
					<apex:pageBlockSectionItem >
                        	<apex:pageBlockTable value="{!milestones}" var="milestoneNumber" id="milestoneTable">
							<apex:column >
								<apex:facet name="header">
									Expected Date
								</apex:facet>
								<apex:outputField value="{!milestones[milestoneNumber].ExDate__c}"  />
							</apex:column>
							<apex:column >
								<apex:facet name="header">
									Description
								</apex:facet>
								<apex:outputField value="{!milestones[milestoneNumber].Description__c}"  />
							</apex:column>
							<apex:column >
								<apex:facet name="header">
									Amount
								</apex:facet>
								<apex:outputField value="{!milestones[milestoneNumber].Amount__c}"  />
							</apex:column>
						</apex:pageBlockTable>
					</apex:pageBlockSectionItem>
				</apex:pageBlockSection>
				
				<apex:pageBlockSection title="Relocations / Secondments" collapsible="false" columns="1">
					<apex:pageBlockSectionItem id="relocSection">
                        	<apex:pageBlockTable value="{!relocs}" var="relocNumber" id="relocTable">
                                <apex:column >
                                    <apex:facet name="header">
                                        Name
                                    </apex:facet>
                                    <apex:outputField value="{!relocs[relocNumber].Name__c}"  />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Home Location
                                    </apex:facet>
                                    <apex:outputField value="{!relocs[relocNumber].HomeLocation__c}"  />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Secondment Location
                                    </apex:facet>
                                    <apex:outputField value="{!relocs[relocNumber].SecondmentLocation__c}"  />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Estimated Costs
                                    </apex:facet>
                                    <apex:outputField value="{!relocs[relocNumber].EstimatedCost__c}"  />
                                </apex:column>
                                <apex:column >
                                    <apex:facet name="header">
                                        Attachments
                                    </apex:facet>
                                    <apex:repeat value="{!relocs[relocNumber].Attachments}" var="attach">
                                        <a href="/servlet/servlet.FileDownload?file={!attach.Id}" title="{!attach.Name}">
                                            <img src="PaperClip Icon" />
                                        </a>
                                    </apex:repeat>
                                </apex:column>
                            </apex:pageBlockTable>
					</apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Total Relocation/Secondment Costs to be included" />
                        <apex:outputField value="{!theProject.TotalEstSecondmentCost__c}"/>
                    </apex:pageBlockSectionItem>
				</apex:pageBlockSection>
				
				
				<apex:pageBlockSection title="Budget Questionnaire Attachments" collapsible="false" columns="1" >
				<div class="fileList">
					<apex:pageBlockTable value="{!AttachedBudgetQuestionnaireFiles}" var="attachedBudgetQuestionnaireFile" style="width: 825px;" rendered="{!IF(AttachedBudgetQuestionnaireFiles.size > 0, true, false)}" >
						<apex:column headerValue="File Name">
							<apex:outputLink value="{!URLFOR($Action.Attachment.Download, attachedBudgetQuestionnaireFile.Id)}" target="_blank">
								<apex:outputText value="{!attachedBudgetQuestionnaireFile.Name}" />
							</apex:outputLink>
						</apex:column>
						<apex:column value="{!attachedBudgetQuestionnaireFile.ContentType}" />	
						<apex:column value="{!attachedBudgetQuestionnaireFile.LastModifiedDate}" />	
						<apex:column value="{!attachedBudgetQuestionnaireFile.LastModifiedById}" />
					</apex:pageBlockTable>
				</div>
				<apex:outputText Value="No Budget Questionnaire Attachments were found." rendered="{!IF(AttachedBudgetQuestionnaireFiles.size > 0, false, true)}" />			
				</apex:pageBlockSection>
				
		</apex:pageBlock>

</apex:page>